DROP DATABASE IF EXISTS QLBVMBDB;

CREATE DATABASE IF NOT EXISTS QLBVMBDB;
USE QLBVMBDB;

CREATE TABLE IF NOT EXISTS THAMSO
(
	SoSanBayTGToiDa INT NOT NULL,
    TGBayToiThieu INT NOT NULL, -- phut
    TGDungToiThieu INT NOT NULL, -- phut
    TGDungToiDa INT NOT NULL, -- phut
    TGDatTruocVeToiThieu INT NOT NULL,
    TGHuyDatTruocVeToiThieu INT NOT NULL
);    

CREATE TABLE IF NOT EXISTS SANBAY
(
	MaSanBay VARCHAR(7) PRIMARY KEY,
    TenSanBay VARCHAR(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS HANGGHE
(
	MaHangGhe VARCHAR(7) PRIMARY KEY,
    TenHangGhe VARCHAR(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS CHUYENBAY
(
	MaChuyenBay VARCHAR(7) PRIMARY KEY,
    MaSanBayDi VARCHAR(7) NOT NULL,
    MaSanBayDen VARCHAR(7) NOT NULL,
    NgayBay DATE NOT NULL,
    GioBay TIME NOT NULL,
    ThoiGianBay INT NOT NULL, -- phut
    FOREIGN KEY (MaSanBayDi) REFERENCES SANBAY(MaSanBay),
    FOREIGN KEY (MaSanBayDen) REFERENCES SANBAY(MaSanBay)
);

CREATE TABLE IF NOT EXISTS CTCHUYENBAY
(
	MaChuyenBay VARCHAR(7) NOT NULL,
    MaSanBayTG VARCHAR(7) NOT NULL,
	ThoiGianDung INT, -- phut
    GhiChu VARCHAR(300),
    PRIMARY KEY (MaChuyenBay, MaSanBayTG),
    FOREIGN KEY (MaChuyenBay) REFERENCES CHUYENBAY(MaChuyenBay),
    FOREIGN KEY (MaSanBayTG) REFERENCES SANBAY(MaSanBay)
);

CREATE TABLE IF NOT EXISTS HANGVECB
(
	MaHangGhe VARCHAR(7) NOT NULL,
    MaChuyenBay VARCHAR(7) NOT NULL,
    SoLuongGhe INT NOT NULL,
    SLGheConLai INT DEFAULT 0,
    PRIMARY KEY (MaHangGhe, MaChuyenBay),
    FOREIGN KEY (MaHangGhe) REFERENCES HANGGHE(MaHangGhe),
    FOREIGN KEY (MaChuyenBay) REFERENCES CHUYENBAY(MaChuyenBay)
);

CREATE TABLE IF NOT EXISTS VECHUYENBAY
(
	MaVe VARCHAR(7) PRIMARY KEY,
    MaChuyenBay VARCHAR(7) NOT NULL,
    MaHangGhe VARCHAR(7) NOT NULL,
	TenHanhKhach VARCHAR(100) NOT NULL,
    CMND VARCHAR(20) NOT NULL,
    SoDienThoai VARCHAR(20) NOT NULL,
    DonGia INT NOT NULL,
    TrangThaiVe TINYINT DEFAULT 2,
    -- ThoiDiemThanhToan DATETIME,
    FOREIGN KEY (MaChuyenBay) REFERENCES CHUYENBAY(MaChuyenBay),
    FOREIGN KEY (MaHangGhe) REFERENCES HANGGHE(MaHangGhe)
);

CREATE TABLE IF NOT EXISTS HANGVE_TUYENBAY
(
	MaSanBayDi VARCHAR(7) NOT NULL,
    MaSanBayDen VARCHAR(7) NOT NULL,
    MaHangGhe VARCHAR(7) NOT NULL,
    DonGiaQuyDinh INT NOT NULL,
    PRIMARY KEY (MaSanBayDi, MaSanBayDen, MaHangGhe),
    FOREIGN KEY (MaSanBayDi) REFERENCES SANBAY(MaSanBay),
    FOREIGN KEY (MaSanBayDen) REFERENCES SANBAY(MaSanBay),
    FOREIGN KEY (MaHangGhe) REFERENCES HANGGHE(MaHangGhe)
);


-- ------------------------------------ SANBAY ------------------------------------------------
INSERT INTO SANBAY VALUES ('SB00001', 'Sân bay California');
INSERT INTO SANBAY VALUES ('SB00002', 'Sân bay New York');
INSERT INTO SANBAY VALUES ('SB00003', 'Sân bay Texas');
INSERT INTO SANBAY VALUES ('SB00004', 'Sân bay Los Angeles');
INSERT INTO SANBAY VALUES ('SB00005', 'Sân bay Chicago O\'Hare');
INSERT INTO SANBAY VALUES ('SB00006', 'Sân bay Atlanta Hartsfield-Jackson');
INSERT INTO SANBAY VALUES ('SB00007', 'Sân bay Denver');
INSERT INTO SANBAY VALUES ('SB00008', 'Sân bay Miami');
INSERT INTO SANBAY VALUES ('SB00009', 'Sân bay Seattle-Tacoma');
INSERT INTO SANBAY VALUES ('SB00010', 'Sân bay Washington Dulles');

-- ----------------------------------- HANGGHE ------------------------------------------------
INSERT INTO HANGGHE VALUES ('HG00001', 'Hạng 1');
INSERT INTO HANGGHE VALUES ('HG00002', 'Hạng 2');
INSERT INTO HANGGHE VALUES ('HG00003', 'Hạng sang');
INSERT INTO HANGGHE VALUES ('HG00004', 'Hạng siêu sang');

INSERT INTO THAMSO VALUES (2, 30, 10, 20, 1, 1);

-- --------------------------------- CHUYENBAY -------------------------------------------------
INSERT INTO CHUYENBAY VALUES ('CB00001', 'SB00001', 'SB00002', '2025-06-01', '08:00:00', 180);
INSERT INTO CHUYENBAY VALUES ('CB00002', 'SB00003', 'SB00004', '2025-06-02', '10:30:00', 150);
INSERT INTO CHUYENBAY VALUES ('CB00003', 'SB00005', 'SB00006', '2025-06-03', '12:15:00', 120);
INSERT INTO CHUYENBAY VALUES ('CB00004', 'SB00007', 'SB00008', '2025-06-04', '09:45:00', 200);
INSERT INTO CHUYENBAY VALUES ('CB00005', 'SB00009', 'SB00010', '2025-06-05', '07:20:00', 165);


-- -------------------------------- CTCHUYENBAY ------------------------------------------------ 
INSERT INTO CTCHUYENBAY VALUES ('CB00001', 'SB00003', 30, 'Dừng tiếp nhiên liệu');
INSERT INTO CTCHUYENBAY VALUES ('CB00001', 'SB00004', 25, 'Đón thêm hành khách');
INSERT INTO CTCHUYENBAY VALUES ('CB00002', 'SB00005', 20, NULL);
INSERT INTO CTCHUYENBAY VALUES ('CB00002', 'SB00006', 15, 'Kiểm tra kỹ thuật');
INSERT INTO CTCHUYENBAY VALUES ('CB00003', 'SB00002', 20, 'Nghỉ ngắn giữa chuyến');
INSERT INTO CTCHUYENBAY VALUES ('CB00003', 'SB00007', 15, 'Dừng kỹ thuật');
INSERT INTO CTCHUYENBAY VALUES ('CB00004', 'SB00009', 40, 'Nghỉ giữa hành trình');
INSERT INTO CTCHUYENBAY VALUES ('CB00004', 'SB00001', 25, 'Đón khách VIP');
INSERT INTO CTCHUYENBAY VALUES ('CB00005', 'SB00004', 30, 'Tiếp nhiên liệu và kiểm tra an toàn');
INSERT INTO CTCHUYENBAY VALUES ('CB00005', 'SB00006', 20, 'Dừng nghỉ nhanh');


-- -------------------------------- HANGVECB --------------------------------------------------
INSERT INTO HANGVECB VALUES ('HG00001', 'CB00001', 100, 90);
INSERT INTO HANGVECB VALUES ('HG00002', 'CB00001', 50, 50);
INSERT INTO HANGVECB VALUES ('HG00003', 'CB00001', 200, 196);
INSERT INTO HANGVECB VALUES ('HG00001', 'CB00002', 150, 15);
INSERT INTO HANGVECB VALUES ('HG00004', 'CB00002', 500, 10);
INSERT INTO HANGVECB VALUES ('HG00002', 'CB00003', 200, 0);
INSERT INTO HANGVECB VALUES ('HG00003', 'CB00003', 100, 8);
INSERT INTO HANGVECB VALUES ('HG00001', 'CB00004', 250, 25);
INSERT INTO HANGVECB VALUES ('HG00002', 'CB00004', 300, 30);
INSERT INTO HANGVECB VALUES ('HG00003', 'CB00004', 100, 10);
INSERT INTO HANGVECB VALUES ('HG00004', 'CB00004', 50, 5);
INSERT INTO HANGVECB VALUES ('HG00004', 'CB00005', 500, 100);

-- ------------------------------- HANGVE_TUYENBAY -------------------------------------
-- CB00001
INSERT INTO HANGVE_TUYENBAY VALUES ('SB00001', 'SB00002', 'HG00001', 140000);
INSERT INTO HANGVE_TUYENBAY VALUES ('SB00001', 'SB00002', 'HG00002', 100200);
INSERT INTO HANGVE_TUYENBAY VALUES ('SB00001', 'SB00002', 'HG00003', 200000);

-- CB00002
INSERT INTO HANGVE_TUYENBAY VALUES ('SB00003', 'SB00004', 'HG00001', 300000);
INSERT INTO HANGVE_TUYENBAY VALUES ('SB00003', 'SB00004', 'HG00004', 400000);

-- CB00003
INSERT INTO HANGVE_TUYENBAY VALUES ('SB00005', 'SB00006', 'HG00002', 500000);
INSERT INTO HANGVE_TUYENBAY VALUES ('SB00005', 'SB00006', 'HG00003', 600000);

-- CB00004
INSERT INTO HANGVE_TUYENBAY VALUES ('SB00007', 'SB00008', 'HG00001', 700000);
INSERT INTO HANGVE_TUYENBAY VALUES ('SB00007', 'SB00008', 'HG00002', 800000);
INSERT INTO HANGVE_TUYENBAY VALUES ('SB00007', 'SB00008', 'HG00003', 900000);
INSERT INTO HANGVE_TUYENBAY VALUES ('SB00007', 'SB00008', 'HG00004', 909999);

-- CB00005
INSERT INTO HANGVE_TUYENBAY VALUES ('SB00009', 'SB00010', 'HG00004', 100000);

SELECT * FROM SANBAY;
SELECT * FROM HANGGHE;
SELECT * FROM HANGVECB;
SELECT * FROM CHUYENBAY;
SELECT * FROM CTCHUYENBAY;
SELECT * FROM THAMSO;
SELECT * FROM VECHUYENBAY;
SELECT * FROM HANGVE_TUYENBAY;

SHOW TABLES;

