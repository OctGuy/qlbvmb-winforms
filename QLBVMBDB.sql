DROP DATABASE IF EXISTS QLBVMBDB;

CREATE DATABASE IF NOT EXISTS QLBVMBDB;
USE QLBVMBDB;

CREATE TABLE IF NOT EXISTS THAMSO
(
	SoSanBayTGToiDa INT NOT NULL,
    TGBayToiThieu INT NOT NULL, -- phut
    TGDungToiThieu INT NOT NULL, -- phut
    TGDungToiDa INT NOT NULL -- phut
    -- TGDatTruocVeToiThieu INT NOT NULL,
    -- TGHuyDatTruocVeToiThieu INT NOT NULL
);    

CREATE TABLE IF NOT EXISTS SANBAY
(
	MaSanBay VARCHAR(7) PRIMARY KEY,
    TenSanBay VARCHAR(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS HANGGHE
(
	MaHangGhe VARCHAR(7) PRIMARY KEY,
    TenHangGhe VARCHAR(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS CHUYENBAY
(
	MaChuyenBay VARCHAR(7) PRIMARY KEY,
    MaSanBayDi VARCHAR(7) NOT NULL,
    MaSanBayDen VARCHAR(7) NOT NULL,
    NgayBay DATE NOT NULL,
    GioBay TIME NOT NULL,
    ThoiGianBay INT NOT NULL, -- phut
    FOREIGN KEY (MaSanBayDi) REFERENCES SANBAY(MaSanBay),
    FOREIGN KEY (MaSanBayDen) REFERENCES SANBAY(MaSanBay)
);

CREATE TABLE IF NOT EXISTS CTCHUYENBAY
(
	MaChuyenBay VARCHAR(7) NOT NULL,
    MaSanBayTG VARCHAR(7) NOT NULL,
	ThoiGianDung INT, -- phut
    GhiChu VARCHAR(300),
    PRIMARY KEY (MaChuyenBay, MaSanBayTG),
    FOREIGN KEY (MaChuyenBay) REFERENCES CHUYENBAY(MaChuyenBay),
    FOREIGN KEY (MaSanBayTG) REFERENCES SANBAY(MaSanBay)
);

CREATE TABLE IF NOT EXISTS HANGVECB
(
	MaHangGhe VARCHAR(7) NOT NULL,
    MaChuyenBay VARCHAR(7) NOT NULL,
    SoLuongGhe INT NOT NULL,
    SLGheConLai INT DEFAULT 0,
    PRIMARY KEY (MaHangGhe, MaChuyenBay),
    FOREIGN KEY (MaHangGhe) REFERENCES HANGGHE(MaHangGhe),
    FOREIGN KEY (MaChuyenBay) REFERENCES CHUYENBAY(MaChuyenBay)
);

CREATE TABLE IF NOT EXISTS VECHUYENBAY
(
	MaVe VARCHAR(7) PRIMARY KEY,
    MaChuyenBay VARCHAR(7) NOT NULL,
    MaHangGhe VARCHAR(7) NOT NULL,
	TenHanhKhach VARCHAR(100) NOT NULL,
    CMND VARCHAR(20) NOT NULL,
    SoDienThoai VARCHAR(20) NOT NULL,
    DonGia INT NOT NULL,
    TrangThaiVe TINYINT DEFAULT 2,
    -- ThoiDiemThanhToan DATETIME,
    FOREIGN KEY (MaChuyenBay) REFERENCES CHUYENBAY(MaChuyenBay),
    FOREIGN KEY (MaHangGhe) REFERENCES HANGGHE(MaHangGhe)
);

CREATE TABLE IF NOT EXISTS HANGVE_TUYENBAY
(
	MaSanBayDi VARCHAR(7) NOT NULL,
    MaSanBayDen VARCHAR(7) NOT NULL,
    MaHangGhe VARCHAR(7) NOT NULL,
    DonGiaQuyDinh INT NOT NULL,
    PRIMARY KEY (MaSanBayDi, MaSanBayDen, MaHangGhe),
    FOREIGN KEY (MaSanBayDi) REFERENCES SANBAY(MaSanBay),
    FOREIGN KEY (MaSanBayDen) REFERENCES SANBAY(MaSanBay),
    FOREIGN KEY (MaHangGhe) REFERENCES HANGGHE(MaHangGhe)
);

-- ------------------------------------ SANBAY ------------------------------------------------
INSERT INTO SANBAY VALUES 
('SB00001', 'Sân bay California'),
('SB00002', 'Sân bay New York'),
('SB00003', 'Sân bay Texas'),
('SB00004', 'Sân bay Los Angeles'),
('SB00005', 'Sân bay Chicago O\'Hare'),
('SB00006', 'Sân bay Atlanta Hartsfield-Jackson'),
('SB00007', 'Sân bay Denver'),
('SB00008', 'Sân bay Miami'),
('SB00009', 'Sân bay Seattle-Tacoma'),
('SB00010', 'Sân bay Washington Dulles');

-- ----------------------------------- HANGGHE ------------------------------------------------
INSERT INTO HANGGHE VALUES 
('HG00001', 'Hạng 1'),
('HG00002', 'Hạng 2'),
('HG00003', 'Hạng sang'),
('HG00004', 'Hạng siêu sang');

-- ------------------------------------ THAMSO ------------------------------------------------
INSERT INTO THAMSO VALUES 
(2, 30, 10, 50);

-- --------------------------------- CHUYENBAY -------------------------------------------------
INSERT INTO CHUYENBAY VALUES 
('CB00001', 'SB00001', 'SB00002', '2025-06-01', '08:00:00', 180),
('CB00002', 'SB00003', 'SB00004', '2025-06-02', '10:30:00', 150),
('CB00003', 'SB00005', 'SB00006', '2025-06-03', '12:15:00', 120),
('CB00004', 'SB00007', 'SB00008', '2025-06-04', '09:45:00', 200),
('CB00005', 'SB00009', 'SB00010', '2025-06-05', '07:20:00', 165),
('CB00006', 'SB00001', 'SB00003', '2025-06-06', '08:30:00',  90),
('CB00007', 'SB00002', 'SB00004', '2025-06-07', '09:00:00', 120),
('CB00008', 'SB00005', 'SB00007', '2025-06-08', '10:15:00', 150),
('CB00009', 'SB00006', 'SB00008', '2025-06-09', '11:45:00', 180),
('CB00010', 'SB00009', 'SB00001', '2025-06-10', '13:00:00', 200),
('CB00011', 'SB00003', 'SB00005', '2025-06-11', '14:30:00',  95),
('CB00012', 'SB00004', 'SB00006', '2025-06-12', '15:45:00', 130),
('CB00013', 'SB00007', 'SB00009', '2025-06-13', '17:00:00', 160),
('CB00014', 'SB00008', 'SB00010', '2025-06-14', '18:15:00', 170),
('CB00015', 'SB00010', 'SB00002', '2025-06-15', '19:30:00', 140);

-- -------------------------------- CTCHUYENBAY ------------------------------------------------ 
INSERT INTO CTCHUYENBAY VALUES 
('CB00001', 'SB00003', 30, 'Dừng tiếp nhiên liệu'),
('CB00001', 'SB00004', 25, 'Đón thêm hành khách'),
('CB00002', 'SB00005', 20, NULL),
('CB00002', 'SB00006', 15, 'Kiểm tra kỹ thuật'),
('CB00003', 'SB00002', 20, 'Nghỉ ngắn giữa chuyến'),
('CB00003', 'SB00007', 15, 'Dừng kỹ thuật'),
('CB00004', 'SB00009', 40, 'Nghỉ giữa hành trình'),
('CB00004', 'SB00001', 25, 'Đón khách VIP'),
('CB00005', 'SB00004', 30, 'Tiếp nhiên liệu và kiểm tra an toàn'),
('CB00005', 'SB00006', 20, 'Dừng nghỉ nhanh'),
('CB00006', 'SB00002', 15, 'Dừng kỹ thuật'),
('CB00007', 'SB00005', 10, 'Tiếp nhiên liệu'),
('CB00007', 'SB00006', 20, 'Đón khách'),
('CB00009', 'SB00003', 15, 'Nghỉ ngắn'),
('CB00010', 'SB00004', 10, 'Dừng kỹ thuật'),
('CB00010', 'SB00005', 20, 'Đón khách'),
('CB00012', 'SB00007', 15, 'Tiếp nhiên liệu'),
('CB00013', 'SB00001', 10, 'Dừng kỹ thuật'),
('CB00013', 'SB00002', 20, 'Đón khách'),
('CB00014', 'SB00003', 15, 'Nghỉ ngắn');

-- -------------------------------- HANGVECB --------------------------------------------------
INSERT INTO HANGVECB VALUES 
('HG00001', 'CB00001', 100,  90),
('HG00002', 'CB00001',  50,  50),
('HG00003', 'CB00001', 200, 196),
('HG00001', 'CB00002', 150,  15),
('HG00004', 'CB00002', 500,  10),
('HG00002', 'CB00003', 200,   0),
('HG00003', 'CB00003', 100,   8),
('HG00001', 'CB00004', 250,  25),
('HG00002', 'CB00004', 300,  30),
('HG00003', 'CB00004', 100,  10),
('HG00004', 'CB00004',  50,   5),
('HG00004', 'CB00005', 500, 100),
('HG00001', 'CB00006', 100,  90),
('HG00001', 'CB00007', 120, 110),
('HG00001', 'CB00009', 130, 120),
('HG00001', 'CB00011', 110, 100),
('HG00001', 'CB00013', 150, 140),
('HG00001', 'CB00015', 120, 110),
('HG00002', 'CB00006',  50,  45),
('HG00002', 'CB00008', 150, 140),
('HG00002', 'CB00009',  70,  65),
('HG00002', 'CB00011',  60,  55),
('HG00002', 'CB00013',  70,  65),
('HG00002', 'CB00015',  60,  55),
('HG00003', 'CB00007',  80,  75),
('HG00003', 'CB00010', 160, 150),
('HG00003', 'CB00012', 140, 130),
('HG00003', 'CB00014', 160, 150),
('HG00004', 'CB00008', 100,  95),
('HG00004', 'CB00010',  90,  85),
('HG00004', 'CB00012',  80,  75),
('HG00004', 'CB00014',  90,  85);

-- ------------------------------- VECHUYENBAY -------------------------------------------------
INSERT INTO VECHUYENBAY VALUES 
('VE00001', 'CB00006', 'HG00001', 'Nguyen Van A', '123456789', '0909123456', 140000, 0),
('VE00002', 'CB00006', 'HG00002', 'Tran Thi B',   '987654321', '0912345678', 100200, 0),
('VE00003', 'CB00007', 'HG00001', 'Le Van C',     '112233445', '0923456789', 300000, 0),
('VE00004', 'CB00007', 'HG00003', 'Pham Thi D',   '556677889', '0934567890', 200000, 0),
('VE00005', 'CB00008', 'HG00002', 'Hoang Van E',  '223344556', '0945678901', 500000, 0),
('VE00006', 'CB00008', 'HG00004', 'Do Thi F',     '667788990', '0956789012', 400000, 0),
('VE00007', 'CB00009', 'HG00001', 'Nguyen Thi G', '334455667', '0967890123', 700000, 0),
('VE00008', 'CB00009', 'HG00002', 'Tran Van H',   '778899001', '0978901234', 600000, 1),
('VE00009', 'CB00010', 'HG00003', 'Le Thi I',     '445566778', '0989012345', 900000, 1),
('VE00010', 'CB00010', 'HG00004', 'Pham Van J',   '889900112', '0990123456', 800000, 1),
('VE00011', 'CB00011', 'HG00001', 'Hoang Thi K',  '556677889', '0901234567', 140000, 1),
('VE00012', 'CB00011', 'HG00002', 'Do Van L',     '990011223', '0912345678', 100200, 1),
('VE00013', 'CB00012', 'HG00003', 'Nguyen Van M', '667788990', '0923456789', 200000, 1),
('VE00014', 'CB00012', 'HG00004', 'Tran Thi N',   '001122334', '0934567890', 400000, 1),
('VE00015', 'CB00013', 'HG00001', 'Pham Thi O',   '778899001', '0909012345', 350000, 2),
('VE00016', 'CB00013', 'HG00002', 'Le Van P',     '889900112', '0910123456', 250000, 2),
('VE00017', 'CB00014', 'HG00003', 'Tran Thi Q',   '990011223', '0921234567', 420000, 2),
('VE00018', 'CB00014', 'HG00004', 'Nguyen Van R', '001122334', '0932345678', 320000, 2),
('VE00019', 'CB00015', 'HG00001', 'Hoang Thi S',  '112233445', '0943456789', 290000, 2),
('VE00020', 'CB00015', 'HG00002', 'Do Van T',     '223344556', '0954567890', 210000, 2);

-- ------------------------------- HANGVE_TUYENBAY ---------------------------------------------
INSERT INTO HANGVE_TUYENBAY VALUES 
-- CB00001
('SB00001', 'SB00002', 'HG00001', 140000),
('SB00001', 'SB00002', 'HG00002', 100200),
('SB00001', 'SB00002', 'HG00003', 200000),
-- CB00002
('SB00003', 'SB00004', 'HG00001', 300000),
('SB00003', 'SB00004', 'HG00004', 400000),
-- CB00003
('SB00005', 'SB00006', 'HG00002', 500000),
('SB00005', 'SB00006', 'HG00003', 600000),
-- CB00004
('SB00007', 'SB00008', 'HG00001', 700000),
('SB00007', 'SB00008', 'HG00002', 800000),
('SB00007', 'SB00008', 'HG00003', 900000),
('SB00007', 'SB00008', 'HG00004', 909999),
-- CB00005
('SB00009', 'SB00010', 'HG00004', 100000);

SELECT * FROM SANBAY;
SELECT * FROM HANGGHE;
SELECT * FROM HANGVECB;
SELECT * FROM CHUYENBAY;
SELECT * FROM CTCHUYENBAY;
SELECT * FROM THAMSO;
SELECT * FROM VECHUYENBAY;
SELECT * FROM HANGVE_TUYENBAY;

SHOW TABLES;